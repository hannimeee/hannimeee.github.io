<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Face detection on the browser using JavaScript!</title>
  <script defer src="/FaceRec/face-api.min.js"></script>
  <script defer src="/FaceRec/FaceVideo3.js"></script>
  <link rel="stylesheet" href="/FaceRec/style.css">
  <link rel="stylesheet" href="Log_Stopwatch.css">
  <link rel="stylesheet" href="navBarFaceRecVersion.css"><link>
</head>
<body>

  <div class="navbarFlexboxLEFT">
    <div class="navbarButtons"><a href="/frontEnd/homePage.html">Home Page</a></div>
    <div style="flex: 1; justify-content: flex-end">
      <div class="navbarFlexboxRIGHT">
        <div class="navbarButtons"><a href="FaceRec/Log_Timer.html">Face Rec</a></div>
        <div class="navbarButtons"><a href="/frontEnd/settings_page.html">Settings</a></div>
        <div class="navbarButtons"><a href="graph.html">Graph View</a></div>
      </div>
    </div>
  </div>

  <div class="timerDisplay" id="timerDisplay">00:00:00:00</div>

  <video id="video" width="600" height="450" autoplay></video>
  <!-- Counter container -->
  <div class="counter-container">
    <p class="focusText">Focus Points: <span id="face-detected-count">0</span></p>
    <p class="focusText">Focus Demerits: <span id="face-not-detected-count">0</span></p>
    <p class="focusText">Focus Percentage: <span id="locked-in-percentage">0</span></p>
  </div>

  <div class="timerContainer">
    <div class="Mediabuttons">
      <div><button class=functionButtons id="startButton" onclick="startTimer_onClick()">Start</button></div>
      <div><button class=functionButtons id="pauseButton" onclick="pauseTimer()">Pause</button></div>
      <div><button class=functionButtons id="resetButton" onclick="resetTimer()">Reset</button></div>
      <div><button class=functionButtons id="logButton">Log</button></div>
      <div><button class=functionButtons onclick="triggerDownload()">Export CSV</button></div>
  <div>

  <div class=timeLogconsole id="timelog-container">
      <h3>Time Log</h3>
      <table id="timelog-table">
        <tr>
          <th>Time In</th>
          <th>Time Out</th>
          <th>Efficiency (%)</th>
        </tr>
      </table>
    </div>
  </div>

  <input type="file" id="csvFile" accept=".csv">
  <button id="uploadButton">Upload CSV</button>

  <script>
    document.getElementById('uploadButton').addEventListener('click', async () => {
      const fileInput = document.getElementById('csvFile');
      const file = fileInput.files[0];
      if (!file) return;

      const formData = new FormData();
      formData.append('file', file);

      try {
        const response = await fetch('http://localhost:3000/upload-csv', {
          method: 'POST',
          body: formData
        });
        if (response.ok) {
          console.log('CSV file uploaded successfully.');
        } else {
          console.error('Failed to upload CSV file.');
        }
      } catch (error) {
        console.error('Error uploading CSV file:', error);
      }
    });
  </script>
    <script>
      // Example time log data
      const timeLogData = {
        currentTimeIn: '2024-04-06 09:00:00',
        currentTimeOut: '2024-04-06 17:00:00',
        efficiency: 85,
      };
  
      // Make a POST request to the backend
      fetch('http://localhost:3000/timelog', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(timeLogData),
      })
      .then(response => {
        if (response.ok) {
          console.log('Time log data sent successfully.');
        } else {
          console.error('Failed to send time log data.');
        }
      })
      .catch(error => {
        console.error('Error sending time log data:', error);
      });
    </script>

<script type='text/javascript' src='/FaceRec/timerScript.js'></script>
<!-- <script type='text/javascript' src='effiencyNCV.js'></script> -->

</body>
</html>